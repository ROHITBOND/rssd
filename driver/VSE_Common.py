#####################################################################
### Rohde & Schwarz Automation for demonstration use.
###
### Purpose: Vector Signal Explorer Common Functions
### Author:  Martin C Lim
### Date:    2018.03.28
### Requird: python -m pip install pyvisa
###          yaVISA
import FSW_Common

class VSE(FSW_Common.VSA):
   def __init__(self):
      pass
      
   #####################################################################
   ### VSE Display
   #####################################################################
   def Set_Group(self,Chan):
      ##################################################################
      ### SANALYZER, IQ, PNOISE, NOISE, Spur, ADEM, V5GT, LTE, OFDMVSA
      ##################################################################
      ChList = self.query('INST:LIST?').split(',')
      #print ChList
      if ("'" + Chan + "'") in ChList:
         pass
      else:
         self.write(":INST:CRE %s,'%s'"%(Chan,sName))
      self.write(":INST:SEL '%s'"%sName)

   #####################################################################
   ### VSE Attenuation
   #####################################################################

   #####################################################################
   ### VSE Frequency
   #####################################################################

   #####################################################################
   ### VSE Time/Sweep
   #####################################################################

   def Set_SweepCont(self,iON):
      if iON > 0:
         self.write('INIT:SEQ:MODE CONT');            #Continuous Sweep
      else:
         self.write('INIT:SEQ:MODE SING');           #Single Sweep


   #####################################################################
   ### VSE IQ Analyzer
   #####################################################################

   #####################################################################
   ### VSE Common Query
   #####################################################################

   #####################################################################
   ### VSE marker
   #####################################################################

#####################################################################
### Run if Main
#####################################################################
if __name__ == "__main__":
   ### this won't be run when imported
   VSE = VSE()
   VSE.VISA_Open("127.0.0.1")       #Prints IDN String
   print(VSE.Get_Channels())
